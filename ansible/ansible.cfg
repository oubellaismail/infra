[defaults]
inventory = inventories/from_terraform.yml
remote_user = root
private_key_file = ~/.ssh/digitalocean
host_key_checking = False
timeout = 30
gather_timeout = 30
fact_caching = jsonfile
fact_caching_connection = /tmp/ansible_fact_cache
fact_caching_timeout = 3600
stdout_callback = yaml
stderr_callback = yaml
log_path = ./ansible.log
retry_files_enabled = True
retry_files_save_path = ./retry
roles_path = ./roles
collections_path = ./collections
ansible_managed = Ansible managed: {file} modified on %Y-%m-%d %H:%M:%S by {uid} on {host}

# Performance tuning
forks = 10
poll_interval = 1
gather_subset = !hardware
# CRITICAL FIX: Disable module compression to avoid the compression warning
module_compression = zip
jinja2_extensions = jinja2.ext.loopcontrols,jinja2.ext.do

# Security
command_warnings = True
deprecation_warnings = False
system_warnings = True
interpreter_python = auto_silent

[inventory]
enable_plugins = advanced_host_list, constructed, ini, yaml

[ssh_connection]
# Ensure every connection supports ProxyJump + agent forwarding
ssh_args = -o ForwardAgent=yes -o ControlMaster=auto -o ControlPersist=600s \
           -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no \
           -o IdentitiesOnly=yes
control_path_dir = /tmp/.ansible-cp
control_path = %(directory)s/%%h-%%p-%%r
# CRITICAL FIX: Disable pipelining to avoid SSH issues with ProxyCommand
pipelining = False
retries = 3
# CRITICAL FIX: Don't use SFTP with ProxyCommand
use_sftp = False

[persistent_connection]
connect_timeout = 30
connect_retries = 30
connect_interval = 1

[paramiko_connection]
record_host_keys = False

[colors]
highlight = white
verbose = blue
warn = bright purple
error = red
debug = dark gray
deprecate = purple
skip = cyan
unreachable = red
ok = green
changed = yellow
diff_add = green
diff_remove = red
diff_lines = cyan

[diff]
always = False
context = 3